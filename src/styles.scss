// Angular Material theming: light and dark themes via data-theme attribute.
@use '@angular/material' as mat;

// --- App palette (CSS variables): light (default) and dark ---
// WCAG 2.1 AA: text-primary and text-secondary meet 4.5:1 (normal) on --background.
:root,
html {
  --background: #f8f9fa;
  --text-primary: #1a1d23;
  --text-secondary: #64748b;
  --sidebar-border: rgba(0, 0, 0, 0.05);
  --sidebar-shadow: 4px 0 15px -3px rgba(0, 0, 0, 0.15);
}

html[data-theme='dark'],
html.dark {
  --background: #0f172a;
  --text-primary: #f1f5f9;
  --text-secondary: #94a3b8;
  --sidebar-border: rgba(255, 255, 255, 0.1);
  --sidebar-shadow: 4px 0 15px -3px rgba(0, 0, 0, 0.35);
}

// Light theme: violet + orange (unusual, distinctive)
html {
  height: 100%;
  min-height: 100vh;
  @include mat.theme((
    color: (
      primary: mat.$violet-palette,
      tertiary: mat.$orange-palette,
      theme-type: light,
    ),
    typography: Roboto,
    density: 0,
  ));
}

// Dark theme: yellow + black (surfaces dark, accents yellow)
html[data-theme='dark'] {
  @include mat.theme((
    color: (
      primary: mat.$yellow-palette,
      tertiary: mat.$orange-palette,
      theme-type: dark,
    ),
    typography: Roboto,
    density: 0,
  ));
}

// Global typography and background: use app palette + smooth theme transition
body {
  color-scheme: light dark;
  background-color: var(--background);
  color: var(--text-secondary);
  font: var(--mat-sys-body-medium);
  margin: 0;
  height: 100%;
  min-height: 100vh;
  transition: background-color 0.3s ease, color 0.3s ease;
}

h1, h2, h3, h4, h5, h6 {
  color: var(--text-primary);
  transition: color 0.3s ease;
}

p {
  color: var(--text-secondary);
  transition: color 0.3s ease;
}

// Outer layer: Topics panel and Practice link only (use app palette)
.app-sidebar .sidenav-content {
  color: var(--text-primary);
  transition: color 0.3s ease;

  .sidenav-accordion {
    .mat-expansion-panel {
      background: transparent !important;
      box-shadow: none !important;
      border: none;

      &::before {
        display: none;
      }
    }

    .mat-expansion-panel-header {
      background: transparent !important;
      border: none;
      min-height: 48px;

      &:hover {
        background: rgba(0, 0, 0, 0.04) !important;
      }
    }

    .mat-expansion-panel-body {
      background: transparent !important;
      border: none;
    }
  }

  > .mat-mdc-nav-list .mat-mdc-list-item:hover {
    background: rgba(0, 0, 0, 0.04) !important;
  }
}

// Nested accordion (JavaScript, Angular, etc.): just text, no panel styling
.app-sidebar .sidenav-content .topics-accordion {
  .mat-expansion-panel {
    background: transparent !important;
    box-shadow: none !important;
    border: none;

    &::before {
      display: none;
    }
  }

  .mat-expansion-panel-header {
    padding-block: 0.25rem;
    min-height: unset;
    height: auto;
    background: transparent !important;
    border: none;
    box-shadow: none !important;

    &:hover {
      background: rgba(0, 0, 0, 0.04) !important;
    }

    .mat-content {
      align-items: center;
    }

    .mat-expansion-indicator {
      margin-inline-start: 0.25rem;
    }
  }

  .mat-expansion-panel-body {
    padding-inline: 0.5rem 1rem;
    padding-block: 0;
    padding-bottom: 0.25rem;
    background: transparent !important;
    border: none;
    box-shadow: none !important;
  }

  .mat-mdc-nav-list {
    padding-inline: 0;
    background: transparent;
  }

  .mat-mdc-list-item {
    background: transparent !important;
    min-height: 2rem;

    &:hover {
      background: rgba(0, 0, 0, 0.04) !important;
    }

    &.nav-sublink {
      color: var(--text-secondary);
    }
  }
}

html[data-theme='dark'] .app-sidebar .sidenav-content {
  .sidenav-accordion .mat-expansion-panel-header:hover {
    background: rgba(255, 255, 255, 0.06) !important;
  }

  > .mat-mdc-nav-list .mat-mdc-list-item:hover {
    background: rgba(255, 255, 255, 0.06) !important;
  }

  .topics-accordion .mat-expansion-panel-header:hover,
  .topics-accordion .mat-mdc-list-item:hover {
    background: rgba(255, 255, 255, 0.06) !important;
  }
}

